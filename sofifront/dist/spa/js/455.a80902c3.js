"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[455],{61455:(e,l,t)=>{t.r(l),t.d(l,{default:()=>S});var o=t(83673),a=t(62323);const d={class:"row"},s={class:"col-12 col-md-3"},i={class:"col-12 col-md-3"},n={class:"col-12 col-md-2 text-center"},r={class:"col-12 col-md-2 text-center"},u={class:"col-12 col-md-4"},c=["onClick"],p={style:{"max-width":"80px"}},m={class:"absolute-full flex flex-center"},_={class:"absolute-full flex flex-center"},h={class:"absolute-full flex flex-center"},f={class:"absolute-full flex flex-center"},w={class:"text-bold text-right"},b={class:"col-12 col-md-8"},g={style:{height:"350px",width:"100%"}},v={class:"col-12 q-mt-md"},x={class:"text-center"},z={class:"text-center"},D={class:"text-center"},k={class:"text-center"},C={class:"text-center"},W={class:"text-center"};function L(e,l,t,L,O,y){const V=(0,o.up)("q-input"),P=(0,o.up)("q-select"),M=(0,o.up)("q-btn"),A=(0,o.up)("q-badge"),q=(0,o.up)("q-linear-progress"),E=(0,o.up)("q-markup-table"),T=(0,o.up)("l-tile-layer"),N=(0,o.up)("l-tooltip"),Q=(0,o.up)("l-icon"),Y=(0,o.up)("l-marker"),Z=(0,o.up)("l-map"),R=(0,o.up)("q-card-section"),F=(0,o.up)("q-card"),H=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(H,{class:"bg-grey-3 q-pa-xs"},{default:(0,o.w5)((()=>[(0,o.Wm)(F,{flat:"",bordered:""},{default:(0,o.w5)((()=>[(0,o.Wm)(R,null,{default:(0,o.w5)((()=>[(0,o._)("div",d,[(0,o._)("div",s,[(0,o.Wm)(V,{modelValue:O.fecha,"onUpdate:modelValue":l[0]||(l[0]=e=>O.fecha=e),label:"Fecha",type:"date",dense:"",outlined:""},null,8,["modelValue"])]),(0,o._)("div",i,[(0,o.Wm)(P,{modelValue:O.tipo,"onUpdate:modelValue":l[1]||(l[1]=e=>O.tipo=e),label:"Tipo",dense:"",outlined:"",options:O.tipos,"emit-value":"","map-options":""},null,8,["modelValue","options"])]),(0,o._)("div",n,[(0,o.Wm)(M,{label:"Buscar",color:"primary",dense:"",onClick:y.buscar,icon:"search","no-caps":"",loading:O.loading},null,8,["onClick","loading"])]),(0,o._)("div",r,[(0,o.Wm)(M,{label:"Ver Todos",color:"grey",dense:"",flat:"",onClick:y.verTodos,icon:"list","no-caps":""},null,8,["onClick"])]),(0,o._)("div",u,[(0,o.Wm)(E,{flat:"",bordered:"",dense:"","wrap-cells":""},{default:(0,o.w5)((()=>[l[5]||(l[5]=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"#"),(0,o._)("th",null,"Pedidos"),(0,o._)("th",null,"Cantidades")])],-1)),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(O.pedidos.users,((l,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t,onClick:e=>y.seleccionar(l),class:"cursor-pointer"},[(0,o._)("td",null,(0,a.zw)(t+1),1),(0,o._)("td",null,[(0,o._)("div",p,(0,a.zw)(e.$filters.capitalize(l.nombreCompleto)),1)]),(0,o._)("td",null,[(0,o.Wm)(q,{size:"20px",value:1,color:"accent"},{default:(0,o.w5)((()=>[(0,o._)("div",m,[(0,o.Wm)(A,{color:"white","text-color":"black",label:"Clientes "+l.clientes.length},null,8,["label"])])])),_:2},1024),(0,o.Wm)(q,{size:"20px",value:l.pedidos.creados/l.pedidos.cantidad,color:"green"},{default:(0,o.w5)((()=>[(0,o._)("div",_,[(0,o.Wm)(A,{color:"white","text-color":"black",label:"Pedido "+l.pedidos.creados},null,8,["label"])])])),_:2},1032,["value"]),(0,o.Wm)(q,{size:"20px",value:l.pedidos.nopedido/l.pedidos.cantidad,color:"red"},{default:(0,o.w5)((()=>[(0,o._)("div",h,[(0,o.Wm)(A,{color:"white","text-color":"black",label:"No pedido "+l.pedidos.nopedido},null,8,["label"])])])),_:2},1032,["value"]),(0,o.Wm)(q,{size:"20px",value:l.pedidos.parado/l.pedidos.cantidad,color:"orange"},{default:(0,o.w5)((()=>[(0,o._)("div",f,[(0,o.Wm)(A,{color:"white","text-color":"black",label:"Parado "+l.pedidos.parado},null,8,["label"])])])),_:2},1032,["value"])])],8,c)))),128))]),(0,o._)("tfoot",null,[(0,o._)("tr",null,[l[3]||(l[3]=(0,o._)("td",null,null,-1)),l[4]||(l[4]=(0,o._)("td",{class:"text-right text-bold"},"Total",-1)),(0,o._)("td",w,(0,a.zw)(y.total),1)])])])),_:1})]),(0,o._)("div",b,[(0,o._)("div",g,[(0,o.Wm)(Z,{modelValue:O.zoom,"onUpdate:modelValue":l[2]||(l[2]=e=>O.zoom=e),zoom:O.zoom,center:O.center},{default:(0,o.w5)((()=>{var e;return[(0,o.Wm)(T,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(null===(e=O.pedidosMapa)||void 0===e?void 0:e.users,(e=>((0,o.wg)(),(0,o.iD)(o.HY,null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.clientes,((e,l)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[y.isValidLatLng(e.Latitud,e.longitud)?((0,o.wg)(),(0,o.j4)(Y,{key:l,"lat-lng":[parseFloat(e.Latitud),parseFloat(e.longitud)]},{default:(0,o.w5)((()=>[(0,o.Wm)(N,{content:e.Nombres},null,8,["content"]),(0,o.Wm)(Q,null,{default:(0,o.w5)((()=>[(0,o.Wm)(A,{style:{padding:"2px"},color:"PEDIDO"===e.estado?"green":"NO PEDIDO"===e.estado?"red":"PARADO"===e.estado?"orange":"grey"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.Cod_Aut),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1032,["lat-lng"])):(0,o.kq)("",!0)],64)))),256))],64)))),256))]})),_:1},8,["modelValue","zoom","center"])])]),(0,o._)("div",v,[(0,o.Wm)(E,{flat:"",bordered:"",dense:"","wrap-cells":""},{default:(0,o.w5)((()=>[l[6]||(l[6]=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"#"),(0,o._)("th",null,"Vendedor"),(0,o._)("th",null,"Total Clientes"),(0,o._)("th",null,"Pedido"),(0,o._)("th",null,"No Pedido"),(0,o._)("th",null,"Retorno"),(0,o._)("th",null,"Faltaron"),(0,o._)("th",null,"Efectividad")])],-1)),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(O.pedidos.users,((l,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t},[(0,o._)("td",null,(0,a.zw)(t+1),1),(0,o._)("td",null,(0,a.zw)(e.$filters.capitalize(l.nombreCompleto)),1),(0,o._)("td",x,(0,a.zw)(l.pedidos.cantidad),1),(0,o._)("td",z,(0,a.zw)(l.pedidos.creados),1),(0,o._)("td",D,(0,a.zw)(l.pedidos.nopedido),1),(0,o._)("td",k,(0,a.zw)(l.pedidos.parado),1),(0,o._)("td",C,(0,a.zw)(l.pedidos.faltaron),1),(0,o._)("td",W,(0,a.zw)((l.pedidos.creados/l.pedidos.cantidad*100).toFixed(1))+"% ",1)])))),128))])])),_:1})])])])),_:1})])),_:1})])),_:1})}t(19544);var O=t(8892),y=t(11488),V=t.n(y);const P={name:"MapaVendedorVisita",components:{LMap:O.iA,LIcon:O.QC,LTileLayer:O.Hw,LMarker:O.$R,LTooltip:O.Gs},data(){return{center:[-17.969721,-67.114493],zoom:13,fecha:V()().format("YYYY-MM-DD"),loading:!1,pedidos:[],pedidosAll:[],pedidosMapa:[],tipo:"",tipos:[{label:"TODOS",value:""},{label:"CERDO",value:"CERDO"},{label:"EMBUTIDO",value:"NORMAL"},{label:"POLLO",value:"POLLO"},{label:"RES",value:"RES"}]}},mounted(){this.buscar()},methods:{isValidLatLng(e,l){const t=parseFloat(e),o=parseFloat(l);return!isNaN(t)&&!isNaN(o)&&0!==t&&0!==o},buscar(){this.loading=!0,this.$api.post("mapaVendedorVisita",{fecha:this.fecha,tipo:this.tipo}).then((e=>{e.data.users.forEach((e=>{let l=0,t=0,o=0,a=0;e.clientes.forEach((e=>{"PEDIDO"===e.estado?l++:"NO PEDIDO"===e.estado?t++:"PARADO"===e.estado?o++:a++})),e.pedidos={creados:l,nopedido:t,parado:o,faltaron:a,cantidad:e.clientes.length}})),this.pedidos=e.data,this.pedidosMapa={...e.data},this.pedidosAll={...e.data}})).finally((()=>{this.loading=!1}))},seleccionar(e){this.pedidosMapa={...this.pedidosMapa,users:this.pedidosAll.users.filter((l=>l.CodAut===e.CodAut))}},verTodos(){this.pedidosMapa={...this.pedidosAll}}},computed:{total(){var e,l;let t=0;return null!==(e=this.pedidos)&&void 0!==e&&null!==(l=e.users)&&void 0!==l&&l.length&&(t=this.pedidos.users.reduce(((e,l)=>{var t;return e+((null===(t=l.pedidos)||void 0===t?void 0:t.cantidad)||0)}),0)),t}}};var M=t(74260),A=t(24379),q=t(10151),E=t(25589),T=t(64689),N=t(63314),Q=t(2165),Y=t(30481),Z=t(51598),R=t(69721),F=t(7518),H=t.n(F);const I=(0,M.Z)(P,[["render",L]]),S=I;H()(P,"components",{QPage:A.Z,QCard:q.Z,QCardSection:E.Z,QInput:T.Z,QSelect:N.Z,QBtn:Q.Z,QMarkupTable:Y.Z,QLinearProgress:Z.Z,QBadge:R.Z})}}]);