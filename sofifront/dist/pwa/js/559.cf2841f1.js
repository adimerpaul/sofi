"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[559],{18559:(a,o,e)=>{e.r(o),e.d(o,{default:()=>k});var i=e(83673),n=e(62323);const l={class:"row"},r={class:"col-12 col-md-8"},c={class:"col-12 col-md-4 flex flex-center"};function s(a,o,e,s,t,d){const p=(0,i.up)("q-input"),f=(0,i.up)("q-btn"),u=(0,i.up)("q-td"),g=(0,i.up)("q-table"),b=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(b,{class:"q-pa-md"},{default:(0,i.w5)((()=>[(0,i._)("div",l,[(0,i._)("div",r,[(0,i.Wm)(p,{modelValue:t.fecha,"onUpdate:modelValue":o[0]||(o[0]=a=>t.fecha=a),type:"date",label:"Filtrar por Fecha",onChange:d.cargarBonificaciones,outlined:"",loading:t.loading,dense:""},null,8,["modelValue","onChange","loading"])]),(0,i._)("div",c,[(0,i.Wm)(f,{label:"Recargar",color:"primary",onClick:d.cargarBonificaciones,icon:"refresh","no-caps":"",loading:t.loading},null,8,["onClick","loading"])])]),(0,i.Wm)(g,{rows:t.bonificaciones,columns:t.columns,"row-key":"codAut",title:"Bonificaciones Pendientes",dense:"","rows-per-page-options":[0],"wrap-cells":"",flat:"",bordered:""},{"body-cell-aprobar":(0,i.w5)((a=>[(0,i.Wm)(u,{props:a},{default:(0,i.w5)((()=>[a.row.aprobacion?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(f,{key:0,dense:"",size:"md","no-caps":"",label:"Aprobar",color:"green",onClick:o=>d.aprobar(a.row),loading:t.loading,icon:"check_circle_outline"},null,8,["onClick","loading"]))])),_:2},1032,["props"])])),"body-cell-productos":(0,i.w5)((a=>[(0,i.Wm)(u,{props:a},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.row.productos,((a,o)=>((0,i.wg)(),(0,i.iD)("div",{key:o},(0,n.zw)(a.producto)+" ("+(0,n.zw)(a.cantidad)+") ",1)))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns"])])),_:1})}var t=e(11488),d=e.n(t);const p={data(){return{loading:!1,fecha:d()().format("YYYY-MM-DD"),bonificaciones:[],columns:[{name:"codAut",label:"Código",field:"NroPed",align:"left"},{name:"cliente",label:"Cliente",field:a=>{var o;return(null===(o=a.cliente)||void 0===o?void 0:o.Nombres)||""},align:"left"},{name:"usuario",label:"Usuario",field:"usuario",align:"left"},{name:"productos",label:"Productos",field:"productos",align:"left"},{name:"comentario",label:"Comentario",field:"comentario",align:"left"},{name:"aprobado",label:"Aprobado",field:a=>a.aprobacion||"—",align:"left"},{name:"aprobar",label:"Acción",field:"aprobar",align:"center"}]}},methods:{async cargarBonificaciones(){this.loading=!0;try{const a=await this.$api.get("/bonificaciones",{params:{fecha:this.fecha}});this.bonificaciones=a.data}catch(a){this.$q.notify({message:"Error al cargar bonificaciones",color:"negative"})}finally{this.loading=!1}},async aprobar(a){if(a.aprobacion)this.$q.notify({message:"Esta bonificación ya fue aprobada",color:"warning"});else{this.loading=!0;try{await this.$api.post("/bonificacioneAprobar",{NroPed:a.NroPed}),this.$q.notify({message:"Bonificación aprobada",color:"positive"}),this.cargarBonificaciones()}catch(i){var o,e;const a=(null===(o=i.response)||void 0===o||null===(e=o.data)||void 0===e?void 0:e.message)||"Error al aprobar";this.$q.notify({message:a,color:"negative"})}finally{this.loading=!1}}}},mounted(){this.cargarBonificaciones()}};var f=e(74260),u=e(24379),g=e(64689),b=e(2165),m=e(55242),h=e(83884),w=e(7518),y=e.n(w);const v=(0,f.Z)(p,[["render",s]]),k=v;y()(p,"components",{QPage:u.Z,QInput:g.Z,QBtn:b.Z,QTable:m.Z,QTd:h.Z})}}]);