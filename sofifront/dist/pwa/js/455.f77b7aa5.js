"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[455],{61455:(e,l,t)=>{t.r(l),t.d(l,{default:()=>$});var o=t(83673),a=t(62323);const d={class:"row"},s={class:"col-12 col-md-3"},i={class:"col-12 col-md-3"},n={class:"col-12 col-md-2 text-center"},r={class:"col-12 col-md-2 text-center"},u={class:"col-12 col-md-4"},c=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"#"),(0,o._)("th",null,"Pedidos"),(0,o._)("th",null,"Cantidades")])],-1),p=["onClick"],m={style:{"max-width":"80px"}},_={class:"absolute-full flex flex-center"},h={class:"absolute-full flex flex-center"},f={class:"absolute-full flex flex-center"},w={class:"absolute-full flex flex-center"},b=(0,o._)("td",null,null,-1),g=(0,o._)("td",{class:"text-right text-bold"},"Total",-1),v={class:"text-bold text-right"},x={class:"col-12 col-md-8"},z={style:{height:"350px",width:"100%"}},D={class:"col-12 q-mt-md"},k=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"#"),(0,o._)("th",null,"Vendedor"),(0,o._)("th",null,"Total Clientes"),(0,o._)("th",null,"Pedido"),(0,o._)("th",null,"No Pedido"),(0,o._)("th",null,"Retorno"),(0,o._)("th",null,"Faltaron"),(0,o._)("th",null,"Efectividad")])],-1),C={class:"text-center"},W={class:"text-center"},L={class:"text-center"},O={class:"text-center"},y={class:"text-center"},V={class:"text-center"};function P(e,l,t,P,M,A){const q=(0,o.up)("q-input"),E=(0,o.up)("q-select"),T=(0,o.up)("q-btn"),N=(0,o.up)("q-badge"),Q=(0,o.up)("q-linear-progress"),Y=(0,o.up)("q-markup-table"),Z=(0,o.up)("l-tile-layer"),R=(0,o.up)("l-tooltip"),F=(0,o.up)("l-icon"),H=(0,o.up)("l-marker"),I=(0,o.up)("l-map"),S=(0,o.up)("q-card-section"),U=(0,o.up)("q-card"),B=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(B,{class:"bg-grey-3 q-pa-xs"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{flat:"",bordered:""},{default:(0,o.w5)((()=>[(0,o.Wm)(S,null,{default:(0,o.w5)((()=>[(0,o._)("div",d,[(0,o._)("div",s,[(0,o.Wm)(q,{modelValue:M.fecha,"onUpdate:modelValue":l[0]||(l[0]=e=>M.fecha=e),label:"Fecha",type:"date",dense:"",outlined:""},null,8,["modelValue"])]),(0,o._)("div",i,[(0,o.Wm)(E,{modelValue:M.tipo,"onUpdate:modelValue":l[1]||(l[1]=e=>M.tipo=e),label:"Tipo",dense:"",outlined:"",options:M.tipos,"emit-value":"","map-options":""},null,8,["modelValue","options"])]),(0,o._)("div",n,[(0,o.Wm)(T,{label:"Buscar",color:"primary",dense:"",onClick:A.buscar,icon:"search","no-caps":"",loading:M.loading},null,8,["onClick","loading"])]),(0,o._)("div",r,[(0,o.Wm)(T,{label:"Ver Todos",color:"grey",dense:"",flat:"",onClick:A.verTodos,icon:"list","no-caps":""},null,8,["onClick"])]),(0,o._)("div",u,[(0,o.Wm)(Y,{flat:"",bordered:"",dense:"","wrap-cells":""},{default:(0,o.w5)((()=>[c,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(M.pedidos.users,((l,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t,onClick:e=>A.seleccionar(l),class:"cursor-pointer"},[(0,o._)("td",null,(0,a.zw)(t+1),1),(0,o._)("td",null,[(0,o._)("div",m,(0,a.zw)(e.$filters.capitalize(l.nombreCompleto)),1)]),(0,o._)("td",null,[(0,o.Wm)(Q,{size:"20px",value:1,color:"accent"},{default:(0,o.w5)((()=>[(0,o._)("div",_,[(0,o.Wm)(N,{color:"white","text-color":"black",label:"Clientes "+l.clientes.length},null,8,["label"])])])),_:2},1024),(0,o.Wm)(Q,{size:"20px",value:l.pedidos.creados/l.pedidos.cantidad,color:"green"},{default:(0,o.w5)((()=>[(0,o._)("div",h,[(0,o.Wm)(N,{color:"white","text-color":"black",label:"Pedido "+l.pedidos.creados},null,8,["label"])])])),_:2},1032,["value"]),(0,o.Wm)(Q,{size:"20px",value:l.pedidos.nopedido/l.pedidos.cantidad,color:"red"},{default:(0,o.w5)((()=>[(0,o._)("div",f,[(0,o.Wm)(N,{color:"white","text-color":"black",label:"No pedido "+l.pedidos.nopedido},null,8,["label"])])])),_:2},1032,["value"]),(0,o.Wm)(Q,{size:"20px",value:l.pedidos.parado/l.pedidos.cantidad,color:"orange"},{default:(0,o.w5)((()=>[(0,o._)("div",w,[(0,o.Wm)(N,{color:"white","text-color":"black",label:"Parado "+l.pedidos.parado},null,8,["label"])])])),_:2},1032,["value"])])],8,p)))),128))]),(0,o._)("tfoot",null,[(0,o._)("tr",null,[b,g,(0,o._)("td",v,(0,a.zw)(A.total),1)])])])),_:1})]),(0,o._)("div",x,[(0,o._)("div",z,[(0,o.Wm)(I,{modelValue:M.zoom,"onUpdate:modelValue":l[2]||(l[2]=e=>M.zoom=e),zoom:M.zoom,center:M.center},{default:(0,o.w5)((()=>{var e;return[(0,o.Wm)(Z,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(null===(e=M.pedidosMapa)||void 0===e?void 0:e.users,(e=>((0,o.wg)(),(0,o.iD)(o.HY,null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.clientes,((e,l)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[A.isValidLatLng(e.Latitud,e.longitud)?((0,o.wg)(),(0,o.j4)(H,{key:l,"lat-lng":[parseFloat(e.Latitud),parseFloat(e.longitud)]},{default:(0,o.w5)((()=>[(0,o.Wm)(R,{content:e.Nombres},null,8,["content"]),(0,o.Wm)(F,null,{default:(0,o.w5)((()=>[(0,o.Wm)(N,{style:{padding:"2px"},color:"PEDIDO"===e.estado?"green":"NO PEDIDO"===e.estado?"red":"PARADO"===e.estado?"orange":"grey"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.Cod_Aut),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1032,["lat-lng"])):(0,o.kq)("",!0)],64)))),256))],64)))),256))]})),_:1},8,["modelValue","zoom","center"])])]),(0,o._)("div",D,[(0,o.Wm)(Y,{flat:"",bordered:"",dense:"","wrap-cells":""},{default:(0,o.w5)((()=>[k,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(M.pedidos.users,((l,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t},[(0,o._)("td",null,(0,a.zw)(t+1),1),(0,o._)("td",null,(0,a.zw)(e.$filters.capitalize(l.nombreCompleto)),1),(0,o._)("td",C,(0,a.zw)(l.pedidos.cantidad),1),(0,o._)("td",W,(0,a.zw)(l.pedidos.creados),1),(0,o._)("td",L,(0,a.zw)(l.pedidos.nopedido),1),(0,o._)("td",O,(0,a.zw)(l.pedidos.parado),1),(0,o._)("td",y,(0,a.zw)(l.pedidos.faltaron),1),(0,o._)("td",V,(0,a.zw)((l.pedidos.creados/l.pedidos.cantidad*100).toFixed(1))+"% ",1)])))),128))])])),_:1})])])])),_:1})])),_:1})])),_:1})}t(19544);var M=t(8892),A=t(11488),q=t.n(A);const E={name:"MapaVendedorVisita",components:{LMap:M.iA,LIcon:M.QC,LTileLayer:M.Hw,LMarker:M.$R,LTooltip:M.Gs},data(){return{center:[-17.969721,-67.114493],zoom:13,fecha:q()().format("YYYY-MM-DD"),loading:!1,pedidos:[],pedidosAll:[],pedidosMapa:[],tipo:"",tipos:[{label:"TODOS",value:""},{label:"CERDO",value:"CERDO"},{label:"EMBUTIDO",value:"NORMAL"},{label:"POLLO",value:"POLLO"},{label:"RES",value:"RES"}]}},mounted(){this.buscar()},methods:{isValidLatLng(e,l){const t=parseFloat(e),o=parseFloat(l);return!isNaN(t)&&!isNaN(o)&&0!==t&&0!==o},buscar(){this.loading=!0,this.$api.post("mapaVendedorVisita",{fecha:this.fecha,tipo:this.tipo}).then((e=>{e.data.users.forEach((e=>{let l=0,t=0,o=0,a=0;e.clientes.forEach((e=>{"PEDIDO"===e.estado?l++:"NO PEDIDO"===e.estado?t++:"PARADO"===e.estado?o++:a++})),e.pedidos={creados:l,nopedido:t,parado:o,faltaron:a,cantidad:e.clientes.length}})),this.pedidos=e.data,this.pedidosMapa={...e.data},this.pedidosAll={...e.data}})).finally((()=>{this.loading=!1}))},seleccionar(e){this.pedidosMapa={...this.pedidosMapa,users:this.pedidosAll.users.filter((l=>l.CodAut===e.CodAut))}},verTodos(){this.pedidosMapa={...this.pedidosAll}}},computed:{total(){var e,l;let t=0;return null!==(e=this.pedidos)&&void 0!==e&&null!==(l=e.users)&&void 0!==l&&l.length&&(t=this.pedidos.users.reduce(((e,l)=>{var t;return e+((null===(t=l.pedidos)||void 0===t?void 0:t.cantidad)||0)}),0)),t}}};var T=t(74260),N=t(24379),Q=t(10151),Y=t(25589),Z=t(64689),R=t(63314),F=t(2165),H=t(30481),I=t(51598),S=t(69721),U=t(7518),B=t.n(U);const K=(0,T.Z)(E,[["render",P]]),$=K;B()(E,"components",{QPage:N.Z,QCard:Q.Z,QCardSection:Y.Z,QInput:Z.Z,QSelect:R.Z,QBtn:F.Z,QMarkupTable:H.Z,QLinearProgress:I.Z,QBadge:S.Z})}}]);