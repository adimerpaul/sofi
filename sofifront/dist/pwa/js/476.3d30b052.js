"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[476],{78476:(e,l,o)=>{o.r(l),o.d(l,{default:()=>R});var a=o(83673),d=o(62323),t=o(98880);const i={class:"row"},s={class:"col-12 col-md-3"},n={class:"col-12 col-md-3"},r={class:"col-12 col-md-2 text-center"},u=(0,a._)("div",{class:"col-12"},null,-1),c={class:"col-12 col-md-4"},p=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"#"),(0,a._)("th",null,"Pedidos"),(0,a._)("th",null,"Cantidades")])],-1),m=["onClick"],h={style:{"max-width":"80px","wrap-option":"wrap"}},v={class:"absolute-full flex flex-center"},g={class:"absolute-full flex flex-center"},f={class:"absolute-full flex flex-center"},b=(0,a._)("td",null,null,-1),_=(0,a._)("td",{class:"text-right text-bold"},"Total",-1),w={class:"text-bold text-right"},x={class:"col-12 col-md-8"},k={style:{height:"350px",width:"100%"}};function C(e,l,o,C,y,W){const z=(0,a.up)("q-input"),D=(0,a.up)("q-select"),L=(0,a.up)("q-btn"),q=(0,a.up)("q-badge"),M=(0,a.up)("q-linear-progress"),E=(0,a.up)("q-markup-table"),O=(0,a.up)("LTileLayer"),V=(0,a.up)("l-tooltip"),A=(0,a.up)("l-icon"),Q=(0,a.up)("l-marker"),T=(0,a.up)("l-map"),Z=(0,a.up)("q-card-section"),$=(0,a.up)("q-card"),P=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(P,{class:"bg-grey-3 q-pa-xs"},{default:(0,a.w5)((()=>[(0,a.Wm)($,{flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a._)("div",s,[(0,a.Wm)(z,{modelValue:y.fecha,"onUpdate:modelValue":l[0]||(l[0]=e=>y.fecha=e),label:"Fecha",type:"date",dense:"",outlined:""},null,8,["modelValue"])]),(0,a._)("div",n,[(0,a.Wm)(D,{modelValue:y.tipo,"onUpdate:modelValue":l[1]||(l[1]=e=>y.tipo=e),label:"Tipo",dense:"",outlined:"",options:y.tipos,"emit-value":"","map-options":""},null,8,["modelValue","options"])]),(0,a._)("div",r,[(0,a.Wm)(L,{label:"Buscar",color:"primary",dense:"",onClick:W.buscar,icon:"search","no-caps":"",loading:y.loading},null,8,["onClick","loading"])]),u,(0,a._)("div",c,[(0,a.Wm)(E,{flat:"",bordered:"",dense:"","wrap-cells":""},{default:(0,a.w5)((()=>[p,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(y.pedidos.users,((l,o)=>((0,a.wg)(),(0,a.iD)("tr",{key:o,onClick:e=>W.seleccionar(l)},[(0,a._)("td",null,(0,d.zw)(o+1),1),(0,a._)("td",null,[l.pedidos.creados>0?((0,a.wg)(),(0,a.j4)(L,{key:0,class:"q-mr-sm",color:"orange",size:"xs",icon:"send",label:"Enviar emegencia",loading:y.loading,dense:"","no-caps":"",onClick:(0,t.iM)((e=>W.enviarPedidosEmergencia(l)),["stop"])},null,8,["loading","onClick"])):(0,a.kq)("",!0),(0,a._)("div",h,(0,d.zw)(e.$filters.capitalize(l.nombreCompleto)),1)]),(0,a._)("td",null,[(0,a.Wm)(M,{size:"20px",value:1,color:"accent"},{default:(0,a.w5)((()=>[(0,a._)("div",v,[(0,a.Wm)(q,{color:"white","text-color":"black",label:"Total "+l.pedidos.cantidad},null,8,["label"])])])),_:2},1024),(0,a.Wm)(M,{size:"20px",value:l.pedidos.creados/l.pedidos.cantidad,color:"blue"},{default:(0,a.w5)((()=>[(0,a._)("div",g,[(0,a.Wm)(q,{color:"white","text-color":"black",label:"Creados "+l.pedidos.creados},null,8,["label"])])])),_:2},1032,["value"]),(0,a.Wm)(M,{size:"20px",value:l.pedidos.enviados/l.pedidos.cantidad,color:"green"},{default:(0,a.w5)((()=>[(0,a._)("div",f,[(0,a.Wm)(q,{color:"white","text-color":"black",label:"Enviados "+l.pedidos.enviados},null,8,["label"])])])),_:2},1032,["value"])])],8,m)))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[b,_,(0,a._)("td",w,(0,d.zw)(W.total),1)])])])),_:1})]),(0,a._)("div",x,[(0,a._)("div",k,[(0,a.Wm)(T,{modelValue:y.zoom,"onUpdate:modelValue":l[2]||(l[2]=e=>y.zoom=e),zoom:y.zoom,center:y.center},{default:(0,a.w5)((()=>{var e;return[(0,a.Wm)(O,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===(e=y.pedidosMapa)||void 0===e?void 0:e.users,(e=>{var l;return(0,a.wg)(),(0,a.iD)(a.HY,null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===e||void 0===e||null===(l=e.pedidos)||void 0===l?void 0:l.pedidos,((e,l)=>((0,a.wg)(),(0,a.j4)(Q,{key:l,"lat-lng":[parseFloat(e.pedido.cliente.Latitud),parseFloat(e.pedido.cliente.longitud)]},{default:(0,a.w5)((()=>[(0,a.Wm)(V,{content:e.pedido.cliente.Nombres},null,8,["content"]),(0,a.Wm)(A,null,{default:(0,a.w5)((()=>[(0,a.Wm)(q,{style:{padding:"2px"},color:"CREADO"===e.pedido.estado?"blue":"green"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,d.zw)(e.pedido.idCli),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1032,["lat-lng"])))),128))],64)})),256))]})),_:1},8,["modelValue","zoom","center"])])])])])),_:1})])),_:1})])),_:1})}o(19544);var y=o(11488),W=o.n(y),z=o(8892);const D={name:"MapaVendedor",components:{LMap:z.iA,LIcon:z.QC,LTileLayer:z.Hw,LMarker:z.$R,LTooltip:z.Gs},data(){return{center:[-17.969721,-67.114493],zoom:13,fecha:W()().format("YYYY-MM-DD"),loading:!1,pedidos:[],pedidosAll:[],pedidosMapa:[],tipos:[{label:"TODOS",value:""},{label:"CERDO",value:"CERDO"},{label:"EMBUTIDO",value:"NORMAL"},{label:"POLLO",value:"POLLO"},{label:"RES",value:"RES"}],tipo:""}},mounted(){this.buscar()},methods:{enviarPedidosEmergencia(e){this.loading=!0,this.$api.post("enviarPedidosEmergencia",{user:e.CodAut,fecha:this.fecha}).then((e=>{const l=e.data.pedidosCondeuda;let o="";for(let a=0;a<l.length;a++)o+=`<div> DEUDA ${a+1}.- ${l[a].Nombres} <br> ${l[a].Telf} <br> ${l[a].Direccion}</div>`;this.$q.notify({type:"positive",message:'Se enviaron los pedidos de emergencia <br> <div style="max-height: 200px; overflow-y: auto;">'+o+"</div>",position:"top",html:!0}),this.buscar()})).catch((e=>{this.$q.notify({type:"negative",message:e.response.data.message})})).finally((()=>{this.loading=!1}))},seleccionar(e){this.pedidosMapa.users=this.pedidosAll.users.filter((l=>l.CodAut===e.CodAut))},buscar(){this.loading=!0,this.$api.post("mapaVendedor",{fecha:this.fecha,tipo:this.tipo}).then((e=>{this.pedidos=e.data,this.pedidosMapa={...e.data},this.pedidosAll={...e.data}})).finally((()=>{this.loading=!1}))}},computed:{total(){let e=0;for(let a=0;a<(null===(l=this.pedidos)||void 0===l||null===(o=l.users)||void 0===o?void 0:o.length);a++){var l,o;e+=this.pedidos.users[a].pedidos.cantidad}return e}}};var L=o(74260),q=o(24379),M=o(10151),E=o(25589),O=o(64689),V=o(63314),A=o(2165),Q=o(30481),T=o(51598),Z=o(69721),$=o(7518),P=o.n($);const Y=(0,L.Z)(D,[["render",C]]),R=Y;P()(D,"components",{QPage:q.Z,QCard:M.Z,QCardSection:E.Z,QInput:O.Z,QSelect:V.Z,QBtn:A.Z,QMarkupTable:Q.Z,QLinearProgress:T.Z,QBadge:Z.Z})}}]);