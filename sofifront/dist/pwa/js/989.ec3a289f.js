"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[989],{26989:(e,l,o)=>{o.r(l),o.d(l,{default:()=>R});var a=o(83673),t=o(62323);const d={class:"row"},s={class:"col-12 col-md-3"},i={class:"col-12 col-md-3"},n={class:"col-12 col-md-2 text-center"},r={class:"col-12 col-md-2 text-center"},u={class:"col-12 col-md-4"},c=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"#"),(0,a._)("th",null,"Pedidos"),(0,a._)("th",null,"Cantidades")])],-1),p=["onClick"],m={style:{"max-width":"80px"}},h={class:"absolute-full flex flex-center"},f={class:"absolute-full flex flex-center"},g={class:"absolute-full flex flex-center"},b={class:"absolute-full flex flex-center"},v=(0,a._)("td",null,null,-1),_=(0,a._)("td",{class:"text-right text-bold"},"Total",-1),w={class:"text-bold text-right"},x={class:"col-12 col-md-8"},k={style:{height:"350px",width:"100%"}};function D(e,l,o,D,W,C){const L=(0,a.up)("q-input"),O=(0,a.up)("q-select"),z=(0,a.up)("q-btn"),V=(0,a.up)("q-badge"),y=(0,a.up)("q-linear-progress"),M=(0,a.up)("q-markup-table"),A=(0,a.up)("l-tile-layer"),P=(0,a.up)("l-tooltip"),q=(0,a.up)("l-icon"),E=(0,a.up)("l-marker"),Q=(0,a.up)("l-map"),T=(0,a.up)("q-card-section"),Z=(0,a.up)("q-card"),N=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(N,{class:"bg-grey-3 q-pa-xs"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(T,null,{default:(0,a.w5)((()=>[(0,a._)("div",d,[(0,a._)("div",s,[(0,a.Wm)(L,{modelValue:W.fecha,"onUpdate:modelValue":l[0]||(l[0]=e=>W.fecha=e),label:"Fecha",type:"date",dense:"",outlined:""},null,8,["modelValue"])]),(0,a._)("div",i,[(0,a.Wm)(O,{modelValue:W.tipo,"onUpdate:modelValue":l[1]||(l[1]=e=>W.tipo=e),label:"Tipo",dense:"",outlined:"",options:W.tipos,"emit-value":"","map-options":""},null,8,["modelValue","options"])]),(0,a._)("div",n,[(0,a.Wm)(z,{label:"Buscar",color:"primary",dense:"",onClick:C.buscar,icon:"search","no-caps":"",loading:W.loading},null,8,["onClick","loading"])]),(0,a._)("div",r,[(0,a.Wm)(z,{label:"Ver Todos",color:"grey",dense:"",flat:"",onClick:C.verTodos,icon:"list","no-caps":""},null,8,["onClick"])]),(0,a._)("div",u,[(0,a.Wm)(M,{flat:"",bordered:"",dense:"","wrap-cells":""},{default:(0,a.w5)((()=>[c,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(W.pedidos.users,((l,o)=>((0,a.wg)(),(0,a.iD)("tr",{key:o,onClick:e=>C.seleccionar(l),class:"cursor-pointer"},[(0,a._)("td",null,(0,t.zw)(o+1),1),(0,a._)("td",null,[(0,a._)("div",m,(0,t.zw)(e.$filters.capitalize(l.nombreCompleto)),1)]),(0,a._)("td",null,[(0,a.Wm)(y,{size:"20px",value:1,color:"accent"},{default:(0,a.w5)((()=>[(0,a._)("div",h,[(0,a.Wm)(V,{color:"white","text-color":"black",label:"Clientes "+l.clientes.length},null,8,["label"])])])),_:2},1024),(0,a.Wm)(y,{size:"20px",value:l.pedidos.creados/l.pedidos.cantidad,color:"green"},{default:(0,a.w5)((()=>[(0,a._)("div",f,[(0,a.Wm)(V,{color:"white","text-color":"black",label:"Pedido "+l.pedidos.creados},null,8,["label"])])])),_:2},1032,["value"]),(0,a.Wm)(y,{size:"20px",value:l.pedidos.nopedido/l.pedidos.cantidad,color:"red"},{default:(0,a.w5)((()=>[(0,a._)("div",g,[(0,a.Wm)(V,{color:"white","text-color":"black",label:"No pedido "+l.pedidos.nopedido},null,8,["label"])])])),_:2},1032,["value"]),(0,a.Wm)(y,{size:"20px",value:l.pedidos.parado/l.pedidos.cantidad,color:"orange"},{default:(0,a.w5)((()=>[(0,a._)("div",b,[(0,a.Wm)(V,{color:"white","text-color":"black",label:"Parado "+l.pedidos.parado},null,8,["label"])])])),_:2},1032,["value"])])],8,p)))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[v,_,(0,a._)("td",w,(0,t.zw)(C.total),1)])])])),_:1})]),(0,a._)("div",x,[(0,a._)("div",k,[(0,a.Wm)(Q,{modelValue:W.zoom,"onUpdate:modelValue":l[2]||(l[2]=e=>W.zoom=e),zoom:W.zoom,center:W.center},{default:(0,a.w5)((()=>{var e;return[(0,a.Wm)(A,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(null===(e=W.pedidosMapa)||void 0===e?void 0:e.users,(e=>((0,a.wg)(),(0,a.iD)(a.HY,null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.clientes,((e,l)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[C.isValidLatLng(e.Latitud,e.longitud)?((0,a.wg)(),(0,a.j4)(E,{key:l,"lat-lng":[parseFloat(e.Latitud),parseFloat(e.longitud)]},{default:(0,a.w5)((()=>[(0,a.Wm)(P,{content:e.Nombres},null,8,["content"]),(0,a.Wm)(q,null,{default:(0,a.w5)((()=>[(0,a.Wm)(V,{style:{padding:"2px"},color:"PEDIDO"===e.estado?"green":"NO PEDIDO"===e.estado?"red":"PARADO"===e.estado?"orange":"grey"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,t.zw)(e.Cod_Aut),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1032,["lat-lng"])):(0,a.kq)("",!0)],64)))),256))],64)))),256))]})),_:1},8,["modelValue","zoom","center"])])])])])),_:1})])),_:1})])),_:1})}o(19544);var W=o(8892),C=o(11488),L=o.n(C);const O={name:"MapaVendedorVisita",components:{LMap:W.iA,LIcon:W.QC,LTileLayer:W.Hw,LMarker:W.$R,LTooltip:W.Gs},data(){return{center:[-17.969721,-67.114493],zoom:13,fecha:L()().format("YYYY-MM-DD"),loading:!1,pedidos:[],pedidosAll:[],pedidosMapa:[],tipo:"",tipos:[{label:"TODOS",value:""},{label:"CERDO",value:"CERDO"},{label:"EMBUTIDO",value:"NORMAL"},{label:"POLLO",value:"POLLO"},{label:"RES",value:"RES"}]}},mounted(){this.buscar()},methods:{isValidLatLng(e,l){const o=parseFloat(e),a=parseFloat(l);return!isNaN(o)&&!isNaN(a)&&0!==o&&0!==a},buscar(){this.loading=!0,this.$api.post("mapaVendedorVisita",{fecha:this.fecha,tipo:this.tipo}).then((e=>{e.data.users.forEach((e=>{let l=0,o=0,a=0;e.clientes.forEach((e=>{"PEDIDO"===e.estado?l++:"NO PEDIDO"===e.estado?o++:"PARADO"===e.estado&&a++})),e.pedidos={creados:l,nopedido:o,parado:a,cantidad:e.clientes.length}})),this.pedidos=e.data,this.pedidosMapa={...e.data},this.pedidosAll={...e.data}})).finally((()=>{this.loading=!1}))},seleccionar(e){this.pedidosMapa={...this.pedidosMapa,users:this.pedidosAll.users.filter((l=>l.CodAut===e.CodAut))}},verTodos(){this.pedidosMapa={...this.pedidosAll}}},computed:{total(){var e,l;let o=0;return null!==(e=this.pedidos)&&void 0!==e&&null!==(l=e.users)&&void 0!==l&&l.length&&(o=this.pedidos.users.reduce(((e,l)=>{var o;return e+((null===(o=l.pedidos)||void 0===o?void 0:o.cantidad)||0)}),0)),o}}};var z=o(74260),V=o(24379),y=o(10151),M=o(25589),A=o(64689),P=o(63314),q=o(2165),E=o(30481),Q=o(51598),T=o(69721),Z=o(7518),N=o.n(Z);const Y=(0,z.Z)(O,[["render",D]]),R=Y;N()(O,"components",{QPage:V.Z,QCard:y.Z,QCardSection:M.Z,QInput:A.Z,QSelect:P.Z,QBtn:q.Z,QMarkupTable:E.Z,QLinearProgress:Q.Z,QBadge:T.Z})}}]);