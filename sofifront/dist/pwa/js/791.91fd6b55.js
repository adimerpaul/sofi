"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[791],{74791:(e,l,o)=>{o.r(l),o.d(l,{default:()=>U});var t=o(83673),a=o(62323);const n={class:"row"},i={class:"col-xs-12 col-md-12"},s=(0,t._)("br",null,null,-1),c=(0,t._)("br",null,null,-1),r={class:"col-xs-12 col-md-12"},d={style:{height:"500px",width:"100%"}},u=(0,t._)("br",null,null,-1),p={class:"col-12 col-md-4"},m={class:"row"},h={class:"col-12 col-md-6"},g={class:"col-12 col-md-6"},f={class:"col-xs-12 col-md-12"},b=["onClick"],w={key:"op"},y={class:"text-h6"},_=(0,t._)("tr",null,[(0,t._)("th",null,"PEDIDO"),(0,t._)("th",null,"CODIGO"),(0,t._)("th",null,"CANTIDAD"),(0,t._)("th",null,"PRODUCTO")],-1);function C(e,l,o,C,D,v){const k=(0,t.up)("q-input"),V=(0,t.up)("LTileLayer"),W=(0,t.up)("LGeoJson"),z=(0,t.up)("l-tooltip"),O=(0,t.up)("q-badge"),P=(0,t.up)("l-icon"),I=(0,t.up)("l-marker"),L=(0,t.up)("l-map"),N=(0,t.up)("q-select"),T=(0,t.up)("q-btn"),Z=(0,t.up)("q-icon"),F=(0,t.up)("q-table"),Q=(0,t.up)("q-card-section"),q=(0,t.up)("q-card"),x=(0,t.up)("q-card-actions"),A=(0,t.up)("q-dialog"),E=(0,t.up)("q-page"),Y=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(E,{class:"bg-grey-3 q-pa-xs"},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{flat:"",bordered:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Q,null,{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",i,[(0,t.Wm)(k,{modelValue:D.fecha,"onUpdate:modelValue":[l[0]||(l[0]=e=>D.fecha=e),v.buscar],label:"Fecha",type:"date",dense:"",outlined:"",min:D.minimo},null,8,["modelValue","min","onUpdate:modelValue"])]),s,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(D.vehiculos,(e=>((0,t.wg)(),(0,t.iD)("div",{class:(0,a.C_)("q-pa-xs col-2 bg-"+e.color),key:e},[(0,t._)("b",null,(0,a.zw)(""==e.placa?"SIN ASIGNAR":e.placa)+" : "+(0,a.zw)(v.calculo(e.placa)),1)],2)))),128)),c,(0,t._)("div",r,[(0,t._)("div",d,[(0,t.Wm)(L,{modelValue:D.zoom,"onUpdate:modelValue":l[1]||(l[1]=e=>D.zoom=e),zoom:D.zoom,center:D.center},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,t.Wm)(W,{geojson:D.geojsonData,options:D.geoJsonOptions},null,8,["geojson","options"]),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(D.clientes,((e,l)=>((0,t.wg)(),(0,t.j4)(I,{key:l,"lat-lng":[parseFloat(e.Latitud),parseFloat(e.longitud)],onClick:l=>v.toggleSeleccion(e)},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{content:e.Nombres+" Total:"+e.importe+" Bs"},null,8,["content"]),(0,t.Wm)(P,null,{default:(0,t.w5)((()=>[(0,t.Wm)(O,{style:{padding:"2px"},color:e.selected?"red":e.color},{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(e.num),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1032,["lat-lng","onClick"])))),128))])),_:1},8,["modelValue","zoom","center"])]),u,(0,t._)("div",p,[(0,t._)("div",m,[(0,t._)("div",h,[(0,t.Wm)(N,{dense:"",outlined:"",modelValue:D.auto,"onUpdate:modelValue":l[2]||(l[2]=e=>D.auto=e),options:D.vehiculos,"option-label":"placa",label:"Camion Asignar"},null,8,["modelValue","options"])]),(0,t._)("div",g,[(0,t.Wm)(T,{color:"green",icon:"local_shipping",onClick:v.cambiar,"no-caps":"",label:"Asignar",loading:D.loading},null,8,["onClick","loading"]),(0,t.Wm)(T,{color:"info",icon:"print",onClick:v.generarPdf,dense:""},null,8,["onClick"])])])])]),(0,t._)("div",f,[(0,t.Wm)(F,{dense:"",rows:D.clientes,columns:D.column,"row-key":"name","rows-per-page-options":["0"],filter:D.filtro,style:{"font-size":"10px",height:"400px"},"virtual-scroll":""},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(k,{outlined:"",dense:"",debounce:"300",modelValue:D.filtro,"onUpdate:modelValue":l[3]||(l[3]=e=>D.filtro=e),placeholder:"buscar"},{append:(0,t.w5)((()=>[(0,t.Wm)(Z,{name:"search"})])),_:1},8,["modelValue"])])),body:(0,t.w5)((e=>[(0,t._)("tr",{class:(0,a.C_)(e.row.selected?"bg-red":"bg-"+e.row.color),style:{"font-size":"10px"},onClick:l=>v.toggleSeleccion(e.row)},[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(D.column,(l=>((0,t.wg)(),(0,t.iD)("td",{key:l.name,style:{"font-size":"10px"}},(0,a.zw)(e.row[l.field]),1)))),128)),(0,t._)("td",w,[(0,t.Wm)(T,{color:"info",icon:"visibility",dense:"",flat:"",onClick:l=>v.verDetalle(e.row)},null,8,["onClick"])])],10,b)])),_:1},8,["rows","columns","filter"])])])])),_:1})])),_:1}),(0,t.Wm)(A,{modelValue:D.dialogDetalle,"onUpdate:modelValue":l[4]||(l[4]=e=>D.dialogDetalle=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(q,null,{default:(0,t.w5)((()=>[(0,t.Wm)(Q,null,{default:(0,t.w5)((()=>[(0,t._)("div",y,(0,a.zw)(D.detalle.Nombres),1)])),_:1}),(0,t.Wm)(Q,null,{default:(0,t.w5)((()=>[(0,t._)("table",null,[_,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(D.detalle.contenido,(e=>((0,t.wg)(),(0,t.iD)("tr",{key:e},[(0,t._)("td",null,(0,a.zw)(e.NroPed),1),(0,t._)("td",null,(0,a.zw)(e.cod_prod),1),(0,t._)("td",null,(0,a.zw)(e.Cant),1),(0,t._)("td",null,(0,a.zw)(e.Producto),1)])))),128))])])),_:1}),(0,t.Wm)(x,{align:"right"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(T,{flat:"",label:"OK",color:"primary"},null,512),[[Y]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}o(19544);var D=o(11488),v=o.n(D),k=o(8892);const V={name:"mapaVendedor",components:{LMap:k.iA,LIcon:k.QC,LTileLayer:k.Hw,LMarker:k.$R,LTooltip:k.Gs,LGeoJson:k.jK},data(){return{styleGeoJSON:e=>({color:e.properties.color||"red",weight:2,opacity:.2,fillOpacity:.3}),center:[-17.969721,-67.114493],filtro:"",listado:[],vehiculos:[],auto:{},zoom:13,fecha:v()().format("YYYY-MM-DD"),minimo:v()().subtract(1,"days").format("YYYY-MM-DD"),loading:!1,clientes:[],seleccionados:[],column:[{label:"OP",name:"op",field:"op",sortable:!0},{label:"N",name:"id",field:"num",sortable:!0,align:"center"},{label:"CINIT",name:"id",field:"Id",sortable:!0,align:"center"},{label:"CLIENTE",name:"nombre",field:"Nombres",sortable:!0,align:"left"},{label:"VENDEDOR",name:"vendedor",field:"vendedor",sortable:!0},{label:"ZONA",name:"zona",field:"territorio",sortable:!0},{label:"PLACA",name:"placa",field:"placa",sortable:!0}],geojsonData:{type:"FeatureCollection",features:[{type:"Feature",properties:{name:"NORTE",color:"#ff0000"},geometry:{type:"Polygon",coordinates:[[[-67.099879,-17.95474],[-67.100311,-17.944827],[-67.085978,-17.93315],[-67.071816,-17.93217],[-67.075506,-17.919267],[-67.113353,-17.911143],[-67.118482,-17.893828],[-67.134844,-17.895579],[-67.130279,-17.92691],[-67.121165,-17.94142],[-67.120854,-17.948468],[-67.122543,-17.949004],[-67.12654,-17.94755],[-67.127607,-17.956572],[-67.125864,-17.957169],[-67.122549,-17.957674],[-67.117989,-17.956378],[-67.115403,-17.956363],[-67.114395,-17.956552],[-67.109594,-17.957144],[-67.107067,-17.957802],[-67.10601,-17.95376],[-67.104272,-17.954179],[-67.103274,-17.954444],[-67.101654,-17.954852],[-67.100496,-17.955036],[-67.099879,-17.95474]]]}},{type:"Feature",properties:{name:"SUD",color:"green"},geometry:{type:"Polygon",coordinates:[[[-67.092556,-17.963821],[-67.093142,-17.971621],[-67.098464,-17.970519],[-67.100556,-17.977601],[-67.108699,-17.975938],[-67.108957,-17.976918],[-67.111124,-17.976509],[-67.110909,-17.975468],[-67.115952,-17.974713],[-67.116317,-17.975489],[-67.116617,-17.976754],[-67.123312,-17.978958],[-67.127775,-17.976999],[-67.133354,-17.972346],[-67.138847,-17.965569],[-67.144598,-17.96663],[-67.142624,-17.973529],[-67.14477,-17.976958],[-67.145242,-17.981693],[-67.141036,-17.983979],[-67.137045,-17.985898],[-67.138847,-17.99349],[-67.136358,-18.006061],[-67.10606,-18.001],[-67.106575,-17.98998],[-67.096447,-17.983285],[-67.091297,-17.993082],[-67.070526,-18.000428],[-67.049898,-17.981904],[-67.047409,-17.97223],[-67.07303,-17.964433],[-67.074703,-17.973006],[-67.075905,-17.974639],[-67.081012,-17.966515],[-67.092556,-17.963821]]]}},{type:"Feature",properties:{name:"BOLIVAR",color:"blue"},geometry:{type:"Polygon",coordinates:[[[-67.098232,-17.969964],[-67.09815,-17.969718],[-67.097392,-17.967165],[-67.105855,-17.965936],[-67.106005,-17.965896],[-67.106906,-17.96859],[-67.108699,-17.975938],[-67.100598,-17.977326],[-67.098464,-17.970519],[-67.093142,-17.971621],[-67.095195,-17.970559],[-67.098171,-17.970048],[-67.098232,-17.969964]]]}},{type:"Feature",properties:{name:"CENTRO",color:"orange"},geometry:{type:"Polygon",coordinates:[[[-67.107257,-17.964448],[-67.112021,-17.964469],[-67.112665,-17.965122],[-67.112922,-17.965897],[-67.118587,-17.963938],[-67.120196,-17.964836],[-67.120432,-17.967877],[-67.122557,-17.967938],[-67.122771,-17.971939],[-67.119316,-17.972449],[-67.11687,-17.974286],[-67.111763,-17.975041],[-67.110948,-17.975164],[-67.109875,-17.971408],[-67.10891,-17.971551],[-67.107107,-17.964489],[-67.107257,-17.964448]]]}},{type:"Feature",properties:{name:"APOYO",color:"purple"},geometry:{type:"Polygon",coordinates:[[[-67.107067,-17.957679],[-67.10971,-17.957368],[-67.112739,-17.956852],[-67.113297,-17.964405],[-67.107031,-17.963751],[-67.106859,-17.965548],[-67.097392,-17.967042],[-67.098232,-17.969964],[-67.093142,-17.971621],[-67.092556,-17.963821],[-67.081012,-17.966392],[-67.089865,-17.947666],[-67.083771,-17.944808],[-67.089092,-17.936153],[-67.100311,-17.944704],[-67.099948,-17.954411],[-67.09995,-17.955219],[-67.105829,-17.953913],[-67.107067,-17.957679]]]}}]},enableTooltip:!0,options:{onEachFeature:this.onEachFeatureFunction},geoJsonOptions:{style:e=>({color:e.properties.color,weight:.5,opacity:.1,fillOpacity:.2})},detalle:[],dialogDetalle:!1}},mounted(){this.buscar(),this.getVehiculo()},methods:{verDetalle(e){e.fecha=this.fecha,console.log(e),this.$api.post("detallePedMap",e).then((l=>{console.log(l.data),this.detalle=e,this.detalle.contenido=l.data,this.dialogDetalle=!0}))},calculo(e){let l=0;return this.clientes.forEach((o=>{o.placa==e&&l++})),l},onEachFeatureFunction(){return this.enableTooltip?(e,l)=>{l.bindTooltip("<div>"+e.properties.name+"</div>",{permanent:!1,sticky:!0})}:()=>{}},generarPdf(){const e=`${this.url}reportePedido/${this.fecha}`;window.open(e,"_blank")},getVehiculo(){this.$api.post("listVehiculo").then((e=>{e.data.forEach((e=>{e.cantidad=0})),this.vehiculos=e.data,this.auto=this.vehiculos[0]}))},buscar(){this.loading=!0,this.clientes=[],this.$api.post("mapClientes",{fecha:this.fecha}).then((e=>{console.log(e.data);let l=1;e.data.forEach((e=>{e.num=l,e.selected=!1,l++})),this.clientes=e.data})).finally((()=>{this.loading=!1}))},toggleSeleccion(e){this.center=[e.Latitud,e.longitud],this.zoom=15,e.selected=!e.selected,e.selected?this.seleccionados.push(e):this.seleccionados=this.seleccionados.filter((l=>l.Id!==e.Id))},cambiar(){this.loading=!0,this.$api.post("updaVehiPed",{fecha:this.fecha,placa:this.auto.placa,listado:this.seleccionados}).then((e=>{this.seleccionados=[],this.buscar()}))}}};var W=o(74260),z=o(24379),O=o(10151),P=o(25589),I=o(64689),L=o(69721),N=o(63314),T=o(2165),Z=o(55242),F=o(24554),Q=o(30481),q=o(46778),x=o(99367),A=o(60677),E=o(7518),Y=o.n(E);const S=(0,W.Z)(V,[["render",C]]),U=S;Y()(V,"components",{QPage:z.Z,QCard:O.Z,QCardSection:P.Z,QInput:I.Z,QBadge:L.Z,QSelect:N.Z,QBtn:T.Z,QTable:Z.Z,QIcon:F.Z,QMarkupTable:Q.Z,QDialog:q.Z,QCardActions:x.Z}),Y()(V,"directives",{ClosePopup:A.Z})}}]);