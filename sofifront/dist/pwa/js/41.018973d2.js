"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[41],{1041:(e,t,a)=>{a.r(t),a.d(t,{default:()=>K});var s=a(83673),i=a(62323),l=a(98880);const o=e=>((0,s.dD)("data-v-4ae99170"),e=e(),(0,s.Cn)(),e),n={class:"row items-center no-wrap"},r={class:"col"},u={key:0},c=(0,s.Uk)(" Sesión iniciada como "),d={class:"text-weight-bold"},m={key:1},g={key:0,class:"col-auto"},h={key:0,class:"q-mb-lg"},p=o((()=>(0,s._)("div",{class:"row items-center no-wrap full-width"},[(0,s._)("img",{class:"g-logo q-mr-sm",alt:"G",src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"}),(0,s._)("div",{class:"col text-center text-weight-medium"},"Continuar con Google")],-1))),f={key:1},w={class:"row no-wrap items-center"},_={class:"col-auto q-pr-md column items-center"},v={class:"bar-wrapper"},b={class:"bar-track"},y={class:"col column justify-around q-gutter-md"},k=(0,s.Uk)("Perfecto!"),W=(0,s.Uk)("¡Todo excelente!"),q=o((()=>(0,s._)("div",{class:"score text-positive"},"10",-1))),x=(0,s.Uk)("Bueno"),S=(0,s.Uk)("Pudo ser mejor"),I=o((()=>(0,s._)("div",{class:"score text-amber-8"},"5",-1))),C=(0,s.Uk)("Malo"),$=(0,s.Uk)("No me gustó"),Z=o((()=>(0,s._)("div",{class:"score text-negative"},"0",-1))),Q={key:0,class:"q-mt-sm text-center text-positive"},G={class:"q-mt-md"};function U(e,t,a,o,U,j){const L=(0,s.up)("q-btn"),z=(0,s.up)("q-banner"),N=(0,s.up)("q-icon"),D=(0,s.up)("q-item-section"),P=(0,s.up)("q-item-label"),T=(0,s.up)("q-item"),A=(0,s.up)("q-input"),B=(0,s.up)("q-card"),E=(0,s.up)("q-page"),O=(0,s.up)("q-page-container"),H=(0,s.up)("q-layout"),J=(0,s.Q2)("ripple");return(0,s.wg)(),(0,s.j4)(H,{view:"lhr Lpr lfr",style:{"min-height":"0"}},{default:(0,s.w5)((()=>[(0,s.Wm)(O,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{class:"flex flex-center bg-grey-1"},{default:(0,s.w5)((()=>[(0,s.Wm)(B,{class:"enc-card q-pa-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(z,{class:(0,i.C_)(["q-mb-md",U.user?"bg-positive text-white":"bg-grey-2"]),rounded:"",dense:""},{default:(0,s.w5)((()=>[(0,s._)("div",n,[(0,s._)("div",r,[U.user?((0,s.wg)(),(0,s.iD)("div",u,[c,(0,s._)("span",d,(0,i.zw)(U.user.email),1)])):((0,s.wg)(),(0,s.iD)("div",m," Inicia sesión con Google para responder la encuesta "))]),U.user?((0,s.wg)(),(0,s.iD)("div",g,[(0,s.Wm)(L,{dense:"",flat:"",icon:"logout",label:"Salir",onClick:j.logout},null,8,["onClick"])])):(0,s.kq)("",!0)])])),_:1},8,["class"]),U.user?((0,s.wg)(),(0,s.iD)("div",f,[(0,s._)("div",w,[(0,s._)("div",_,[(0,s.Wm)(N,{name:"add",size:"24px",class:"text-positive q-mb-sm"}),(0,s._)("div",v,[(0,s._)("div",b,[(0,s._)("div",{class:"bar-fill",style:(0,i.j5)({height:j.fillHeight+"%",background:"linear-gradient(180deg, #21ba45 0%, #f2c037 50%, #f44336 100%)"})},null,4)]),(0,s._)("div",{class:"bar-tick",style:(0,i.j5)({bottom:j.fillHeight+"%"})},null,4)])]),(0,s._)("div",y,[(0,s.wy)(((0,s.wg)(),(0,s.j4)(T,{clickable:"",onClick:t[0]||(t[0]=e=>j.select(10)),class:"rounded-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(D,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(L,{round:"",unelevated:"",size:"lg",color:j.isSel(10)?"positive":"green-5"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,{name:"sentiment_very_satisfied",size:"28px"})])),_:1},8,["color"])])),_:1}),(0,s.Wm)(D,null,{default:(0,s.w5)((()=>[(0,s.Wm)(P,{class:"text-weight-bold"},{default:(0,s.w5)((()=>[k])),_:1}),(0,s.Wm)(P,{caption:""},{default:(0,s.w5)((()=>[W])),_:1})])),_:1}),(0,s.Wm)(D,{side:""},{default:(0,s.w5)((()=>[q])),_:1})])),_:1})),[[J]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(T,{clickable:"",onClick:t[1]||(t[1]=e=>j.select(5)),class:"rounded-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(D,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(L,{round:"",unelevated:"",size:"lg",color:j.isSel(5)?"warning":"amber-5"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,{name:"sentiment_neutral",size:"28px"})])),_:1},8,["color"])])),_:1}),(0,s.Wm)(D,null,{default:(0,s.w5)((()=>[(0,s.Wm)(P,{class:"text-weight-bold"},{default:(0,s.w5)((()=>[x])),_:1}),(0,s.Wm)(P,{caption:""},{default:(0,s.w5)((()=>[S])),_:1})])),_:1}),(0,s.Wm)(D,{side:""},{default:(0,s.w5)((()=>[I])),_:1})])),_:1})),[[J]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(T,{clickable:"",onClick:t[2]||(t[2]=e=>j.select(0)),class:"rounded-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(D,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(L,{round:"",unelevated:"",size:"lg",color:j.isSel(0)?"negative":"red-5"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,{name:"sentiment_very_dissatisfied",size:"28px"})])),_:1},8,["color"])])),_:1}),(0,s.Wm)(D,null,{default:(0,s.w5)((()=>[(0,s.Wm)(P,{class:"text-weight-bold"},{default:(0,s.w5)((()=>[C])),_:1}),(0,s.Wm)(P,{caption:""},{default:(0,s.w5)((()=>[$])),_:1})])),_:1}),(0,s.Wm)(D,{side:""},{default:(0,s.w5)((()=>[Z])),_:1})])),_:1})),[[J]]),(0,s.Wm)(l.uT,{name:"fade"},{default:(0,s.w5)((()=>[U.sent?((0,s.wg)(),(0,s.iD)("div",Q," ¡Gracias por tu respuesta! ✅ ")):(0,s.kq)("",!0)])),_:1})])]),(0,s._)("div",G,[(0,s.Wm)(A,{modelValue:U.comment,"onUpdate:modelValue":t[3]||(t[3]=e=>U.comment=e),type:"textarea",dense:"",autogrow:"",clearable:"",placeholder:"Comentario (opcional)",disable:U.loading},null,8,["modelValue","disable"]),(0,s.Wm)(L,{class:"q-mt-sm",color:"primary",label:"Enviar",loading:U.loading,disable:null===U.score,onClick:j.submit,unelevated:"",rounded:"",icon:"send"},null,8,["loading","disable","onClick"])])])):((0,s.wg)(),(0,s.iD)("div",h,[(0,s.Wm)(L,{class:"btn-google full-width",loading:U.authLoading,onClick:j.loginGoogle,unelevated:""},{default:(0,s.w5)((()=>[p])),_:1},8,["loading","onClick"])]))])),_:1})])),_:1})])),_:1})])),_:1})}a(92100);const j={name:"EncuestaSatisfaccion",props:{refId:{type:[String,Number],default:null},autoSubmit:{type:Boolean,default:!0}},data(){return{score:null,comment:"",loading:!1,sent:!1,user:null,authLoading:!1}},computed:{fillHeight(){return 10===this.score?100:5===this.score?50:(this.score,0)}},mounted(){const e=localStorage.getItem("enc_user");if(e)try{this.user=JSON.parse(e)}catch(t){}this.$firebase&&(this._unsubAuth=this.$firebase.auth().onAuthStateChanged((async e=>{if(e){const t=await e.getIdToken();this.user={uid:e.uid,email:e.email,name:e.displayName,photo:e.photoURL,idToken:t},localStorage.setItem("enc_user",JSON.stringify(this.user))}else this.user=null,localStorage.removeItem("enc_user")})))},methods:{isSel(e){return this.score===e},async select(e){this.score=e,this.autoSubmit&&this.user&&await this.submit(),this.autoSubmit&&!this.user&&this.$q.notify({type:"warning",message:"Inicia sesión con Google para enviar"})},async loginGoogle(){try{if(this.authLoading=!0,this.$loginGoogle)return void await this.$loginGoogle();const e=new this.$firebase.auth.GoogleAuthProvider,t=await this.$firebase.auth().signInWithPopup(e),a=t.user,s=await a.getIdToken();this.user={uid:a.uid,email:a.email,name:a.displayName,photo:a.photoURL,idToken:s},localStorage.setItem("enc_user",JSON.stringify(this.user))}catch(e){console.error(e),this.$q.notify({type:"negative",message:"No se pudo iniciar con Google"})}finally{this.authLoading=!1}},async logout(){try{this.$logout?await this.$logout():await this.$firebase.auth().signOut(),this.user=null,localStorage.removeItem("enc_user")}catch(e){console.error(e)}},async submit(){if(null!==this.score)if(this.user)try{this.loading=!0;const e={score:this.score,comment:this.comment||null,ref_id:this.refId,email:this.user.email,ua:navigator.userAgent};await this.$api.post("encuestas",e),this.sent=!0,this.$q.notify({type:"positive",message:"¡Enviado!"})}catch(e){console.error(e),this.$q.notify({type:"negative",message:"Error al enviar"})}finally{this.loading=!1}else this.$q.notify({type:"warning",message:"Inicia sesión para enviar"})}}};var L=a(74260),z=a(83066),N=a(72652),D=a(24379),P=a(10151),T=a(15607),A=a(2165),B=a(24554),E=a(83414),O=a(52035),H=a(2350),J=a(64689),R=a(46489),V=a(7518),M=a.n(V);const F=(0,L.Z)(j,[["render",U],["__scopeId","data-v-4ae99170"]]),K=F;M()(j,"components",{QLayout:z.Z,QPageContainer:N.Z,QPage:D.Z,QCard:P.Z,QBanner:T.Z,QBtn:A.Z,QIcon:B.Z,QItem:E.Z,QItemSection:O.Z,QItemLabel:H.Z,QInput:J.Z}),M()(j,"directives",{Ripple:R.Z})}}]);