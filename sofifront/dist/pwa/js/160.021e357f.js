"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[160],{79160:(e,l,o)=>{o.r(l),o.d(l,{default:()=>P});var a=o(83673),t=o(62323);const n={class:"row"},i={class:"col-xs-12 col-md-6"},s={class:"col-xs-12 col-md-10"},c=(0,a._)("br",null,null,-1),d={class:"col-xs-12 col-md-4"},r=["onClick"],u={class:"col-xs-12 col-md-6"},m={style:{height:"500px",width:"100%"}},p=(0,a._)("br",null,null,-1),h={class:"col-12 col-md-4"},f={class:"row"},g={class:"col-12 col-md-6"},b={class:"col-12 col-md-6"};function w(e,l,o,w,_,k){const v=(0,a.up)("q-input"),C=(0,a.up)("q-icon"),V=(0,a.up)("q-table"),y=(0,a.up)("LTileLayer"),z=(0,a.up)("l-tooltip"),W=(0,a.up)("q-badge"),L=(0,a.up)("l-icon"),Z=(0,a.up)("l-marker"),x=(0,a.up)("l-map"),Q=(0,a.up)("q-select"),q=(0,a.up)("q-btn"),Y=(0,a.up)("q-card-section"),D=(0,a.up)("q-card"),I=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(I,{class:"bg-grey-3 q-pa-xs"},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(Y,null,{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a._)("div",i,[(0,a._)("div",s,[(0,a.Wm)(v,{modelValue:_.fecha,"onUpdate:modelValue":[l[0]||(l[0]=e=>_.fecha=e),k.buscar],label:"Fecha",type:"date",dense:"",outlined:"",min:_.minimo},null,8,["modelValue","min","onUpdate:modelValue"])]),c,(0,a._)("div",d,[(0,a.Wm)(V,{dense:"",rows:_.clientes,columns:_.column,"row-key":"name","rows-per-page-options":["0"],filter:_.filtro,style:{"font-size":"10px"}},{"top-right":(0,a.w5)((()=>[(0,a.Wm)(v,{outlined:"",dense:"",debounce:"300",modelValue:_.filtro,"onUpdate:modelValue":l[1]||(l[1]=e=>_.filtro=e),placeholder:"buscar"},{append:(0,a.w5)((()=>[(0,a.Wm)(C,{name:"search"})])),_:1},8,["modelValue"])])),body:(0,a.w5)((e=>[(0,a._)("tr",{class:(0,t.C_)(e.row.selected?"bg-red":"bg-"+e.row.color),style:{"font-size":"10px"},onClick:l=>k.toggleSeleccion(e.row)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(_.column,(l=>((0,a.wg)(),(0,a.iD)("td",{key:l.name,style:{"font-size":"10px"}},(0,t.zw)(e.row[l.field]),1)))),128))],10,r)])),_:1},8,["rows","columns","filter"])])]),(0,a._)("div",u,[(0,a._)("div",m,[(0,a.Wm)(x,{modelValue:_.zoom,"onUpdate:modelValue":l[2]||(l[2]=e=>_.zoom=e),zoom:_.zoom,center:_.center},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(_.clientes,((e,l)=>((0,a.wg)(),(0,a.j4)(Z,{key:l,"lat-lng":[parseFloat(e.Latitud),parseFloat(e.longitud)],onClick:l=>k.toggleSeleccion(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{content:e.Nombres},null,8,["content"]),(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[(0,a.Wm)(W,{style:{padding:"2px"},color:e.selected?"red":e.color},{default:(0,a.w5)((()=>[(0,a.Uk)((0,t.zw)(e.num),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1032,["lat-lng","onClick"])))),128))])),_:1},8,["modelValue","zoom","center"])]),p,(0,a._)("div",h,[(0,a._)("div",f,[(0,a._)("div",g,[(0,a.Wm)(Q,{dense:"",outlined:"",modelValue:_.auto,"onUpdate:modelValue":l[3]||(l[3]=e=>_.auto=e),options:_.vehiculos,"option-label":"placa",label:"Camion Asignar"},null,8,["modelValue","options"])]),(0,a._)("div",b,[(0,a.Wm)(q,{color:"green",icon:"local_shipping",onClick:k.cambiar,"no-caps":"",label:"Asignar",loading:_.loading},null,8,["onClick","loading"]),(0,a.Wm)(q,{color:"info",icon:"print",onClick:k.generarPdf,dense:""},null,8,["onClick"])])])])])])])),_:1})])),_:1})])),_:1})}o(19544);var _=o(11488),k=o.n(_),v=o(8892);const C={name:"MapaVendedor",components:{LMap:v.iA,LIcon:v.QC,LTileLayer:v.Hw,LMarker:v.$R,LTooltip:v.Gs},data(){return{center:[-17.969721,-67.114493],filtro:"",listado:[],vehiculos:[],auto:{},zoom:13,fecha:k()().format("YYYY-MM-DD"),minimo:k()().subtract(1,"days").format("YYYY-MM-DD"),loading:!1,clientes:[],seleccionados:[],column:[{label:"OP",name:"op",field:"op",sortable:!0},{label:"N",name:"id",field:"num",sortable:!0,align:"center"},{label:"CINIT",name:"id",field:"Id",sortable:!0,align:"center"},{label:"CLIENTE",name:"nombre",field:"Nombres",sortable:!0,align:"left"},{label:"VENDEDOR",name:"vendedor",field:"vendedor",sortable:!0},{label:"ZONA",name:"zona",field:"territorio",sortable:!0},{label:"PLACA",name:"placa",field:"placa",sortable:!0}]}},mounted(){this.buscar(),this.getVehiculo()},methods:{generarPdf(){const e=`${this.url}reportePedido/${this.fecha}`;window.open(e,"_blank")},getVehiculo(){this.$api.post("listVehiculo").then((e=>{this.vehiculos=e.data,this.auto=this.vehiculos[0]}))},buscar(){this.loading=!0,this.clientes=[],this.$api.post("mapClientes",{fecha:this.fecha}).then((e=>{console.log(e.data);let l=1;e.data.forEach((e=>{e.num=l,l++})),this.clientes=e.data.map((e=>({...e,selected:!1})))})).finally((()=>{this.loading=!1}))},toggleSeleccion(e){this.center=[e.Latitud,e.longitud],this.zoom=15,e.selected=!e.selected,e.selected?this.seleccionados.push(e):this.seleccionados=this.seleccionados.filter((l=>l.Id!==e.Id))},cambiar(){this.loading=!0,this.$api.post("updaVehiPed",{fecha:this.fecha,placa:this.auto.placa,listado:this.seleccionados}).then((e=>{this.seleccionados=[],this.buscar()}))}}};var V=o(74260),y=o(24379),z=o(10151),W=o(25589),L=o(64689),Z=o(55242),x=o(24554),Q=o(30481),q=o(69721),Y=o(63314),D=o(2165),I=o(7518),M=o.n(I);const N=(0,V.Z)(C,[["render",w]]),P=N;M()(C,"components",{QPage:y.Z,QCard:z.Z,QCardSection:W.Z,QInput:L.Z,QTable:Z.Z,QIcon:x.Z,QMarkupTable:Q.Z,QBadge:q.Z,QSelect:Y.Z,QBtn:D.Z})}}]);