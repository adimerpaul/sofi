"use strict";(self["webpackChunksofi"]=self["webpackChunksofi"]||[]).push([[557],{45557:(e,t,l)=>{l.r(t),l.d(t,{default:()=>te});var s=l(83673),a=l(62323);const o=e=>((0,s.dD)("data-v-97fb54cc"),e=e(),(0,s.Cn)(),e),i={class:"row q-col-gutter-md q-mb-md"},r={class:"col-12 col-sm-3"},c={class:"col-12 col-sm-3"},n={class:"col-12 col-sm-3"},d={class:"col-12 col-sm-1"},u={class:"col-12 col-sm-2 flex items-center"},m={class:"col-12 q-mt-sm"},_=o((()=>(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{class:"text-left"},"#"),(0,s._)("th",{class:"text-left"},"Fecha (encuesta / creación)"),(0,s._)("th",{class:"text-left"},"Cliente"),(0,s._)("th",{class:"text-left"},"Usuario"),(0,s._)("th",{class:"text-left"},"Score"),(0,s._)("th",{class:"text-left"},"Comentario"),(0,s._)("th",{class:"text-left"},"Email"),(0,s._)("th",{class:"text-left"},"IP"),(0,s._)("th",{class:"text-left"},"Host"),(0,s._)("th",{class:"text-left"},"Navegador")])],-1))),f={key:0},w={class:"text-left"},p={class:"text-left"},h={class:"text-caption text-grey-7"},g={class:"text-left"},x={class:"text-weight-medium"},v={class:"text-caption text-grey-7"},b={class:"text-caption ellipsis"},k={class:"text-left"},q={class:"text-weight-medium"},y={class:"text-caption text-grey-7"},z={class:"text-caption"},D={class:"text-left"},U={class:"text-left"},C={class:"text-left"},V={class:"text-left"},Z={class:"text-left"},Q={class:"text-caption text-grey-7"},W={class:"text-left"},Y={key:1},I=o((()=>(0,s._)("tr",null,[(0,s._)("td",{colspan:"10",class:"text-center text-grey"},"Sin datos para el filtro seleccionado")],-1))),j=[I],A={key:2},H={colspan:"10",class:"text-center"},M=(0,s.Uk)(" Cargando... ");function S(e,t,l,o,I,S){const T=(0,s.up)("q-input"),P=(0,s.up)("q-select"),B=(0,s.up)("q-btn"),E=(0,s.up)("q-badge"),N=(0,s.up)("q-chip"),$=(0,s.up)("q-tooltip"),F=(0,s.up)("q-spinner"),J=(0,s.up)("q-markup-table"),K=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(K,{class:"q-pa-md"},{default:(0,s.w5)((()=>[(0,s._)("div",i,[(0,s._)("div",r,[(0,s.Wm)(T,{modelValue:I.filters.from,"onUpdate:modelValue":t[0]||(t[0]=e=>I.filters.from=e),type:"date",label:"Desde (fecha encuesta)",dense:"",outlined:""},null,8,["modelValue"])]),(0,s._)("div",c,[(0,s.Wm)(T,{modelValue:I.filters.to,"onUpdate:modelValue":t[1]||(t[1]=e=>I.filters.to=e),type:"date",label:"Hasta (fecha encuesta)",dense:"",outlined:""},null,8,["modelValue"])]),(0,s._)("div",n,[(0,s.Wm)(T,{modelValue:I.filters.usuario,"onUpdate:modelValue":t[2]||(t[2]=e=>I.filters.usuario=e),dense:"",outlined:"",label:"Usuario (ID o texto)",placeholder:"Ej: 123 o Juan / 123456 / @mail",clearable:""},null,8,["modelValue"])]),(0,s._)("div",d,[(0,s.Wm)(P,{modelValue:I.filters.score,"onUpdate:modelValue":t[3]||(t[3]=e=>I.filters.score=e),dense:"",outlined:"",clearable:"",label:"Score",options:[{label:"10",value:10},{label:"5",value:5},{label:"0",value:0}],"emit-value":"","map-options":""},null,8,["modelValue"])]),(0,s._)("div",u,[(0,s.Wm)(B,{loading:I.loading,color:"primary",icon:"search",label:"Buscar","no-caps":"",class:"full-width",onClick:S.load},null,8,["loading","onClick"])]),(0,s._)("div",m,[(0,s.Wm)(E,{color:"grey-8","text-color":"white",class:"q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Total: "+(0,a.zw)(I.rows.length),1)])),_:1}),I.rows.length?((0,s.wg)(),(0,s.j4)(E,{key:0,color:"green-7","text-color":"white",class:"q-pa-sm q-ml-sm"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 10: "+(0,a.zw)(I.rows.filter((e=>10===e.score)).length),1)])),_:1})):(0,s.kq)("",!0),I.rows.length?((0,s.wg)(),(0,s.j4)(E,{key:1,color:"amber-7","text-color":"white",class:"q-pa-sm q-ml-sm"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 5: "+(0,a.zw)(I.rows.filter((e=>5===e.score)).length),1)])),_:1})):(0,s.kq)("",!0),I.rows.length?((0,s.wg)(),(0,s.j4)(E,{key:2,color:"red-7","text-color":"white",class:"q-pa-sm q-ml-sm"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 0: "+(0,a.zw)(I.rows.filter((e=>0===e.score)).length),1)])),_:1})):(0,s.kq)("",!0)])]),(0,s.Wm)(J,{flat:"",bordered:"",dense:""},{default:(0,s.w5)((()=>[_,!I.loading&&I.rows.length?((0,s.wg)(),(0,s.iD)("tbody",f,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(I.rows,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",w,(0,a.zw)(t+1),1),(0,s._)("td",p,[(0,s._)("div",null,(0,a.zw)(e.encuesta_date||"-"),1),(0,s._)("div",h,(0,a.zw)(S.formatDateTime(e.created_at)),1)]),(0,s._)("td",g,[(0,s._)("div",x,(0,a.zw)(e.cliente_nombre||"-"),1),(0,s._)("div",v," Cod_Aut: "+(0,a.zw)(e.cliente_cod_aut)+" · ID: "+(0,a.zw)(e.cliente_id||"-"),1),(0,s._)("div",b,(0,a.zw)(e.cliente_dir||"-")+" ("+(0,a.zw)(e.cliente_zona||"-")+") ",1)]),(0,s._)("td",k,[(0,s._)("div",q,(0,a.zw)(e.usuario_nombre||"-"),1),(0,s._)("div",y," CodAut: "+(0,a.zw)(e.usuario_cod_aut)+" · CI: "+(0,a.zw)(e.usuario_ci||"-"),1),(0,s._)("div",z,(0,a.zw)(e.usuario_correo||"-"),1)]),(0,s._)("td",D,[(0,s.Wm)(N,{square:"",dense:"","text-color":"white",color:10===e.score?"positive":5===e.score?"amber-7":"negative"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(e.score),1)])),_:2},1032,["color"])]),(0,s._)("td",U,[(0,s._)("span",null,(0,a.zw)(e.comment||"-"),1)]),(0,s._)("td",C,(0,a.zw)(e.email||"-"),1),(0,s._)("td",V,(0,a.zw)(e.client_ip||"-"),1),(0,s._)("td",Z,[(0,s._)("div",null,(0,a.zw)(e.origin_host||"-"),1),(0,s._)("div",Q,(0,a.zw)(e.origin_scheme||"-")+(0,a.zw)(e.origin_path?" · "+e.origin_path:""),1)]),(0,s._)("td",W,[e.user_agent?((0,s.wg)(),(0,s.j4)($,{key:0},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(e.user_agent),1)])),_:2},1024)):(0,s.kq)("",!0),(0,s._)("span",null,(0,a.zw)(S.shortUA(e.user_agent)),1)])])))),128))])):I.loading||I.rows.length?((0,s.wg)(),(0,s.iD)("tbody",A,[(0,s._)("tr",null,[(0,s._)("td",H,[(0,s.Wm)(F,{size:"24px",class:"q-mr-sm"}),M])])])):((0,s.wg)(),(0,s.iD)("tbody",Y,j))])),_:1})])),_:1})}var T=l(21082);const P={name:"EncuestaIndex",data(){const e=T.ZP.formatDate(Date.now(),"YYYY-MM-DD");return{loading:!1,rows:[],filters:{from:e,to:e,usuario:"",score:null}}},methods:{formatDateTime(e){return e?T.ZP.formatDate(e,"YYYY-MM-DD HH:mm"):""},shortUA(e){return e?e.length<=48?e:e.slice(0,48)+"…":"-"},async load(){this.loading=!0;try{var e,t;const l={from:this.filters.from||void 0,to:this.filters.to||void 0,usuario:this.filters.usuario||void 0,score:null!==(e=this.filters.score)&&void 0!==e?e:void 0,all:1},s=await this.$api.get("encuestas",{params:l});this.rows=Array.isArray(s.data)?s.data:(null===(t=s.data)||void 0===t?void 0:t.data)||[]}catch(l){console.error(l),this.$q.notify({type:"negative",message:"No se pudo cargar encuestas"}),this.rows=[]}finally{this.loading=!1}}},mounted(){this.load()}};var B=l(74260),E=l(24379),N=l(64689),$=l(63314),F=l(2165),J=l(69721),K=l(30481),G=l(67030),L=l(5363),O=l(39754),R=l(7518),X=l.n(R);const ee=(0,B.Z)(P,[["render",S],["__scopeId","data-v-97fb54cc"]]),te=ee;X()(P,"components",{QPage:E.Z,QInput:N.Z,QSelect:$.Z,QBtn:F.Z,QBadge:J.Z,QMarkupTable:K.Z,QChip:G.Z,QTooltip:L.Z,QSpinner:O.Z})}}]);